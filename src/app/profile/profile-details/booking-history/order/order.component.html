<div *ngIf="order" class="car mt-3" [title]="order?.statusText">
  <div class="car-header w-100" (click)="edit()">
    <div class="col-md-8 car-info-img row">
      <div class="car-img col-4 col-md-2">
        <img [src]="order.car.img" />
      </div>
      <div class="car-info col">
        <h2 class="car-title">{{ order.car.name }}</h2>
        <div class="car-details">
          <span class="car-places"
            ><i class="far fa-calendar-minus"></i
            ><b>{{ fromDate | ngbDate | date: 'dd.MM.yyyy' }} {{ toDate | ngbDate | date: ' - dd.MM.yyyy' }}</b></span
          >
          <span class="driver-license"
            ><i class="far fa-clock"></i><b>{{ api.ngbTimeToString(this.orderForm.get('time').value) }}</b></span
          >
          <!-- <span class="car-kpp"><i class="fas fa-cogs"></i>{{ car.kpp }}</span> -->
        </div>
      </div>
    </div>

    <div class="car-actions col-md-3 text-right d-none d-md-block">
      <div class="price">
        <h2>{{ order.orderSum }} ₽</h2>
        <!-- <span class="text-muted">итого: {{ car.price * 3 }} ₽ за 3 суток</span>  TODO -->
      </div>
    </div>
  </div>
  <span class="status" [ngClass]="[order.statusClass]"></span>

  <div class="row mt-3" [formGroup]="orderForm" *ngIf="isEditing">
    <div class="col-7 col-sm-9 col-md-9 col-xl-6">
      <div class="form-group mb-0">
        <label class="d-block">Период аренды</label>
        <ngbd-datepicker-i18n
          #dp
          (dateSelect)="onDateSelection($event)"
          [dayTemplate]="t"
          [minDate]="this.minDate"
          [maxDate]="maxDate"
          [markDisabled]="isDisabled"
          outsideDays="hidden"
        >
        </ngbd-datepicker-i18n>

        <ng-template #t let-date let-focused="focused">
          <span
            class="custom-day"
            [class.focused]="focused"
            [class.range]="isRange(date)"
            [class.faded]="isHovered(date) || isInside(date)"
            [class.disabled]="isDisabled(date)"
            (mouseenter)="hoveredDate = date"
            (mouseleave)="hoveredDate = null"
          >
            {{ date.day }}
          </span>
        </ng-template>
      </div>
    </div>
    <div class="pt-sm-3 pt-md-0 col-4 col-md-3 col-xl-3">
      <div class="form-group">
        <label>Время подачи</label>
        <ngb-timepicker [readonlyInputs]="true" formControlName="time" [hourStep]="hourStep" [minuteStep]="minuteStep"></ngb-timepicker>
      </div>
    </div>
    <div class="pt-3 pt-md-0 col-sm-8 col-md-12 col-xl-3 d-flex flex-column justify-content-between">
      <div>
        <div class="form-group">
          <label>Место подачи</label>
          <select formControlName="place" class="form-control">
            <option *ngFor="let place of places" [value]="place.id">{{ place.name }}</option>
          </select>
        </div>
      </div>
      <div class="text-right">
        <small class="text-muted"> К оплате {{ order.orderSum }} ₽ </small>
        <div class="btns">
          <button class="btn btn-outline-danger mr-2" (click)="cancel()">
            Отменить
          </button>
          <button class="btn btn-primary" (click)="onSaveClick()">
            Сохранить
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
